PREFIX = "/usr"

PKGSTATEDIR = PREFIX + "/lib/galactic-bloodshed/"

PKGDATADIR = PREFIX + "/share/galactic-bloodshed/"

#DOCDIR = PREFIX + "/share/doc/galactic-bloodshed/"
DOCDIR = PREFIX + "/share/galactic-bloodshed/"

LLVM_COPTS_DEFAULT = [
    "-Werror",
    "-Weverything",
    "-Wno-c++98-compat",  # Keep this one
    "-Wno-padded",  # Keep this one
    "-Wno-c++98-compat-pedantic",  # Keep
]

LLVM_COPTS_OPTIONAL = [
    "-Wno-sign-conversion",
    "-Wno-shorten-64-to-32",
    "-Wno-float-equal",
    "-Wno-old-style-cast",
    "-Wno-conversion",
    "-Wno-comma",
    "-Wno-zero-as-null-pointer-constant",
    "-Wno-unused-parameter",
    "-Wno-conditional-uninitialized",
    "-Wno-sign-compare",
    "-Wno-shadow",
    "-Wno-sizeof-pointer-memaccess",
    "-Wno-switch-enum",
    "-Wno-switch",
    "-Wno-logical-not-parentheses",
    "-Wno-exit-time-destructors",
    "-Wno-global-constructors",
]

LLVM_COPTS = LLVM_COPTS_DEFAULT + LLVM_COPTS_OPTIONAL

GCC_COPTS = [
    "-Wno-sign-compare",
    "-Wno-maybe-uninitialized",
    "-Wno-return-type",
    "-Wno-unused-variable",
]

COPTS = LLVM_COPTS + [
    '-DPKGSTATEDIR=\\"' + PKGSTATEDIR + '\\"',
    '-DPKGDATADIR=\\"' + PKGDATADIR + '\\"',
    '-DDOCDIR=\\"' + DOCDIR + '\\"',
    "-std=c++2a",
    "-O1",
    "-g3",
]

cc_binary(
    name = "makeuniv",
    srcs =
        [
            "GB_server.h",
            "buffers.h",
            "build.h",
            "config.h",
            "doturn.h",
            "files.cc",
            "files.h",
            "files_rw.cc",
            "files_rw.h",
            "files_shl.cc",
            "files_shl.h",
            "globals.h",
            "makeplanet.cc",
            "makeplanet.h",
            "makestar.cc",
            "makestar.h",
            "makeuniv.cc",
            "makeuniv.h",
            "map.h",
            "perm.cc",
            "perm.h",
            "power.h",
            "races.h",
            "rand.cc",
            "rand.h",
            "sector.cc",
            "ships.h",
            "tweakables.h",
            "vars.h",
        ],
    copts = COPTS,
    linkopts = ["-lsqlite3"],
)

cc_binary(
    name = "enrol",
    srcs =
        [
            "GB_server.h",
            "buffers.h",
            "build.h",
            "config.h",
            "doturn.h",
            "enrol.cc",
            "files.cc",
            "files.h",
            "files_rw.cc",
            "files_rw.h",
            "files_shl.cc",
            "files_shl.h",
            "globals.h",
            "map.h",
            "max.cc",
            "max.h",
            "perm.cc",
            "perm.h",
            "power.h",
            "races.h",
            "rand.cc",
            "rand.h",
            "sector.cc",
            "shipdata.h",
            "ships.h",
            "shlmisc.cc",
            "shlmisc.h",
            "tweakables.h",
            "vars.h",
        ],
    copts = COPTS,
    linkopts =
        [
            "-lsqlite3",
            "-lncurses",
        ],
)

cc_import(
    name = "sqlite3",
    interface_library = "libsqlite3.so",
    system_provided = 1,
)

cc_binary(
    name = "GB",
    srcs =
        [
            "GB_server.cc",
            "GB_server.h",
            "VN.cc",
            "VN.h",
            "analysis.cc",
            "analysis.h",
            "autoreport.cc",
            "autoreport.h",
            "autoshoot.cc",
            "autoshoot.h",
            "buffers.h",
            "build.cc",
            "build.h",
            "capital.cc",
            "capital.h",
            "capture.cc",
            "capture.h",
            "config.h",
            "cs.cc",
            "cs.h",
            "csp.h",
            "csp_types.h",
            "declare.cc",
            "declare.h",
            "defense.h",
            "dissolve.cc",
            "dissolve.h",
            "dock.cc",
            "dock.h",
            "dosector.cc",
            "dosector.h",
            "doship.cc",
            "doship.h",
            "doturn.h",
            "doturncmd.cc",
            "doturncmd.h",
            "enslave.cc",
            "enslave.h",
            "examine.cc",
            "examine.h",
            "explore.cc",
            "explore.h",
            "files.cc",
            "files.h",
            "files_rw.cc",
            "files_rw.h",
            "files_shl.cc",
            "files_shl.h",
            "fire.cc",
            "fire.h",
            "fuel.cc",
            "fuel.h",
            "getplace.cc",
            "getplace.h",
            "globals.h",
            "land.cc",
            "land.h",
            "launch.cc",
            "launch.h",
            "load.cc",
            "load.h",
            "map.cc",
            "map.h",
            "max.cc",
            "max.h",
            "misc.cc",
            "misc.h",
            "mobiliz.cc",
            "mobiliz.h",
            "move.cc",
            "move.h",
            "moveplanet.cc",
            "moveplanet.h",
            "moveship.cc",
            "moveship.h",
            "name.cc",
            "name.h",
            "orbit.cc",
            "orbit.h",
            "order.cc",
            "order.h",
            "perm.cc",
            "perm.h",
            "planet.cc",
            "planet.h",
            "power.h",
            "powercmd.cc",
            "powercmd.h",
            "prof.cc",
            "prof.h",
            "races.h",
            "rand.cc",
            "rand.h",
            "relation.cc",
            "relation.h",
            "rst.cc",
            "rst.h",
            "scrap.cc",
            "scrap.h",
            "sector.cc",
            "shipdata.h",
            "ships.cc",
            "ships.h",
            "shlmisc.cc",
            "shlmisc.h",
            "shootblast.cc",
            "shootblast.h",
            "survey.cc",
            "survey.h",
            "tech.cc",
            "tech.h",
            "tele.cc",
            "tele.h",
            "toggle.cc",
            "toggle.h",
            "toxicity.cc",
            "toxicity.h",
            "tweakables.h",
            "vars.h",
            "victory.cc",
            "victory.h",
            "zoom.cc",
            "zoom.h",
        ],
    copts = COPTS,
    linkopts = ["-lsqlite3"],
)

cc_binary(
    name = "racegen",
    srcs =
        [
            "GB_racegen.cc",
            "GB_racegen.h",
            "GB_server.h",
            "buffers.h",
            "build.h",
            "config.h",
            "doturn.h",
            "enroll.cc",
            "enroll.h",
            "files.cc",
            "files.h",
            "files_rw.cc",
            "files_rw.h",
            "files_shl.cc",
            "files_shl.h",
            "game_info.h",
            "globals.h",
            "map.h",
            "max.cc",
            "max.h",
            "perm.cc",
            "perm.h",
            "power.h",
            "racegen.cc",
            "racegen.h",
            "races.h",
            "rand.cc",
            "rand.h",
            "sector.cc",
            "shipdata.h",
            "ships.h",
            "shlmisc.cc",
            "shlmisc.h",
            "tweakables.h",
            "vars.h",
        ],
    copts = COPTS + [
        "-Wno-writable-strings",
    ],
    linkopts = ["-lsqlite3"],
)
